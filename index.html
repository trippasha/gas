<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Моніторинг показників газу та температури</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Стилі — мобільний перший підхід, покращений дизайн без зміни DOM -->
    <style>
        :root{
            --bg: #f6f9fc;
            --card: #ffffff;
            --muted: #6b7280;
            --accent: #2563eb; /* blue-600 */
            --accent-weak: rgba(37,99,235,0.08);
            --success: #16a34a;
            --danger: #dc2626;
            --glass: rgba(255,255,255,0.6);
        }

        /* Базові скини */
        *{box-sizing:border-box}
        html,body{height:100%;margin:0;font-family:system-ui,-apple-system,'Segoe UI',Roboto,'Helvetica Neue',Arial,'Noto Sans',sans-serif;color:#0f172a;background:linear-gradient(180deg,#eef2ff 0%, #f8fafc 100%);-webkit-font-smoothing:antialiased}

        .container{
            max-width:980px;margin:18px auto;padding:14px;border-radius:12px;background:var(--card);box-shadow:0 6px 22px rgba(15,23,42,0.06);
        }

        header h1{font-size:1.25rem;margin:0 0 8px 0;color:#0b1223;font-weight:700}
        h2{font-size:1rem;margin:0 0 8px 0;color:#0b1223}

        /* Форма */
        .form-section{margin-bottom:12px}
        .input-group{display:flex;gap:10px;align-items:center;margin-bottom:10px}
        .input-group label{min-width:110px;font-weight:600;color:var(--muted)}
        .input-group input{flex:1;padding:8px 10px;border:1px solid #e6edf3;border-radius:8px;font-size:0.95rem}
        #date{font-weight:700}

        /* Кнопки */
        .submit-btn{background:linear-gradient(180deg,var(--accent),#1d4ed8);color:#fff;border:none;padding:8px 12px;border-radius:10px;cursor:pointer;font-weight:600;box-shadow:0 6px 18px rgba(37,99,235,0.12);transition:transform .12s ease,box-shadow .12s ease}
        .submit-btn:hover{transform:translateY(-1px);box-shadow:0 10px 24px rgba(37,99,235,0.14)}
        .submit-btn:active{transform:translateY(0)}

        /* Toggle button - subtle variant */
        #toggleShowAll{background:transparent;color:var(--accent);border:1px solid var(--accent);padding:6px 10px;border-radius:999px;font-weight:700}
        #toggleShowAll[aria-pressed="true"]{background:var(--accent);color:#fff}

        /* Картки графіків */
        .chart-container{width:100%;height:420px;border-radius:10px;padding:8px;background:linear-gradient(180deg,var(--glass),#fff)}
        .chart-container canvas{width:100%!important;height:100%!important;display:block}

        /* Таблиці */
        .table-wrapper{overflow:auto;border-radius:8px}
        table{width:100%;border-collapse:separate;border-spacing:0 6px;font-size:0.95rem}
        thead th{background:transparent;text-align:left;padding:8px 12px;color:var(--muted);font-weight:700}
        tbody td{background:#fff;padding:10px 12px;border-bottom:1px solid rgba(15,23,42,0.03)}
        tbody tr{border-radius:6px}

        /* Видалення та інші кнопки */
        .delete-btn{background:transparent;border:1px solid rgba(229,62,62,0.08);color:var(--danger);padding:6px;border-radius:8px;cursor:pointer}

        /* Мобільні специфічні налаштування */
        @media (max-width:600px){
            .container{margin:10px;padding:12px}
            header h1{font-size:1.05rem}
            .input-group{flex-direction:column;align-items:stretch}
            .input-group label{min-width:0;margin-bottom:6px;font-size:0.95rem}
            #date{font-size:1.05rem}
            .chart-container{height:520px;padding:6px}
            .submit-btn{padding:8px 10px;font-size:0.95rem}
            table{font-size:0.9rem}
            thead th:nth-child(2),tbody td:nth-child(2){width:140px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- ДОДАНО: date adapter для Chart.js (time scale) -->
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@2/dist/chartjs-adapter-date-fns.bundle.min.js"></script>
    <!-- ДОДАНО: плагін для панінгу/зуму -->
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.2.0/dist/chartjs-plugin-zoom.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>Моніторинг показників газу та температури</h1>
        </header>

        <main>
            <section class="form-section">
                <h2>1. Додати новий показник</h2>
                <form id="dataForm">
                    <div class="input-group">
                        <label for="date">Дата:</label>
                        <input type="date" id="date" required>
                    </div>
                    
                    <div class="input-group">
                        <label for="gasReading">Показник газу (м³):</label>
                        <input type="number" id="gasReading" required step="any" min="0">
                    </div>
                    
                    <button type="submit" class="submit-btn">Зберегти запис</button>
                </form>
            </section>
            
            <section class="chart-section">
                <div style="display:flex; align-items:center; gap:10px;">
                    <h2>2. Динаміка показників</h2>
                    <!-- Кнопка перемикання між останніми N і всіма даними -->
                    <button id="toggleShowAll" class="submit-btn" style="font-size:0.9em;">Показати всі дані</button>
                    
                    <!-- Вкладки: огляд / детально -->
                    <div style="margin-left:auto; display:flex; gap:8px;">
                        <button id="tabOverview" class="submit-btn" aria-pressed="true">Огляд</button>
                        <button id="tabDetail" class="submit-btn" aria-pressed="false">Температури (детально)</button>
                    </div>
                </div>

                <div id="overviewPanel" class="chart-container" style="margin-top:10px;">
                    <canvas id="gasChart"></canvas>
                </div>

                <!-- Детальний таб, за замовчуванням прихований -->
                <div id="detailPanel" style="display:none; margin-top:10px;">
                    <div style="display:flex; gap:8px; margin-bottom:8px; align-items:center;">
                        <span style="font-weight:600;">Перiод:</span>
                        <button class="period-btn submit-btn" data-days="1">1 доба</button>
                        <button class="period-btn submit-btn" data-days="7">7 дн.</button>
                        <button class="period-btn submit-btn" data-days="14">14 дн.</button>
                        <button class="period-btn submit-btn" data-days="30">30 дн.</button>
                    </div>
                    <div class="chart-container">
                        <canvas id="tempDetailChart"></canvas>
                    </div>
                </div>
            </section>

            <section class="table-section">
                <h2>3. Історія показників</h2>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th>Різниця (м³)</th>
                                <th>Дата</th>
                                <th>Показник газу</th>
                                <th>Температура</th>
                                <th>Дія</th>
                            </tr>
                        </thead>
                        <tbody id="tableBody">
                            </tbody>
                    </table>
                </div>
            </section>
        </main>
    </div>

    <script type="module">
        // Ваш код ініціалізації Firebase тут (залишається незмінним)
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
        import { getFirestore } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBljzKUEOAMc8AbBU-5wnkm6AIQPmLbVuo",
            authDomain: "winter-gas.firebaseapp.com",
            projectId: "winter-gas",
            storageBucket: "winter-gas.firebasestorage.app",
            messagingSenderId: "263460066412",
            appId: "1:263460066412:web:a0697a86f3504674407449",
            measurementId: "G-HBD0JQ2R7X"
        };

        const app = initializeApp(firebaseConfig);
        window.db = getFirestore(app);
        
        console.log("Firebase та Firestore ініціалізовано.");
    </script>
    
    <script src="script.js"></script>
</body>
</html>